parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"app/app.tokens.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@rxdi/core");function n(e){return e.reduce((e,n)=>(e[n]=n,e),Object.create(null))}exports.BooleanUnion=n(["Boolean","Bool","boolean","Boolean[]","boolean[]","[Boolean]","[Bool]","boolean!","Boolean!","[Boolean]!","boolean[]!","Boolean[]!"]),exports.StringUnion=n(["String","string","String[]","string[]","[String]","string!","String!","String[]!","string[]!","[String]!"]),exports.IntegerUnion=n(["Int","integer","number","Number","Num","int","Number[]","number[]","[Number]","number!","[Int]","Number!","number[]!","Number[]!","[Number]!","[Int]!"]),exports.Roots={booleanNode:exports.BooleanUnion,stringNode:exports.StringUnion,numberNode:exports.IntegerUnion},exports.TypesToken=new e.InjectionToken("(@rxdi/graphqj): types-token"),exports.ArgumentsToken=new e.InjectionToken("(@rxdi/graphqj): arguments-token"),exports.ResolversToken=new e.InjectionToken("(@rxdi/graphqj): resolvers-token"),exports.GuardsToken=new e.InjectionToken("(@rxdi/graphqj): resolvers-token"),exports.IsBundlerInstalled=new e.InjectionToken("(@rxdi/graphqj): is-bundler-installed"),exports.Config=new e.InjectionToken;
},{}],"helpers/parse-ast.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("graphql");function n(n){let r;return"string"!==n&&"String"!==n||(r={type:e.GraphQLString}),"boolean"!==n&&"Boolean"!==n&&"Bool"!==n||(r={type:e.GraphQLBoolean}),"number"!==n&&"Number"!==n&&"Int"!==n||(r={type:e.GraphQLInt}),"string!"!==n&&"String!"!==n||(r={type:new e.GraphQLNonNull(e.GraphQLString)}),"boolean!"!==n&&"Boolean!"!==n||(r={type:new e.GraphQLNonNull(e.GraphQLBoolean)}),"number!"!==n&&"Number!"!==n&&"Int"!==n||(r={type:new e.GraphQLNonNull(e.GraphQLInt)}),"string[]"!==n&&"String[]"!==n&&"[String]"!==n||(r={type:new e.GraphQLList(e.GraphQLString)}),"boolean[]"!==n&&"Boolean[]"!==n&&"[Boolean]"!==n&&"[Bool]"!==n||(r={type:new e.GraphQLList(e.GraphQLBoolean)}),"number[]"!==n&&"Number[]"!==n&&"[Number]"!==n&&"[Int]"!==n||(r={type:new e.GraphQLList(e.GraphQLInt)}),"string[]!"!==n&&"String[]!"!==n&&"[String]!"!==n||(r={type:new e.GraphQLNonNull(new e.GraphQLList(e.GraphQLString))}),"boolean[]!"!==n&&"Boolean[]!"!==n&&"[Boolean]!"!==n&&"[Bool]"!==n||(r={type:new e.GraphQLNonNull(new e.GraphQLList(e.GraphQLBoolean))}),"number[]!"!==n&&"Number[]!"!==n&&"[Number]!"!==n&&"[Int]!"!==n||(r={type:new e.GraphQLNonNull(new e.GraphQLList(e.GraphQLInt))}),r}exports.ParseArgs=n;
},{}],"helpers/dynamic-schema/mutators/build-arguments.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@rxdi/core"),r=require("../../../app/app.tokens"),s=require("../../parse-ast");function t(t){Object.keys(t.$args).forEach(o=>{const a={};Object.keys(t.$args[o]).forEach(c=>{a[c]=s.ParseArgs(t.$args[o][c]),e.Container.get(r.TypesToken).set(o,a)})})}exports.buildArguments=t;
},{"../../../app/app.tokens":"app/app.tokens.ts","../../parse-ast":"helpers/parse-ast.ts"}],"helpers/get-first-item.ts":[function(require,module,exports) {
"use strict";function e(e){if(!e)return null;let r;for(const t in e){r=t;break}if(!e[r])throw new Error(`Missing method ${r}`);return e[r]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFirstItem=e;
},{}],"helpers/isFunction.ts":[function(require,module,exports) {
"use strict";function e(e){return"function"==typeof e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isFunction=e;
},{}],"helpers/lazy-types.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lazyTypes=new Map;
},{}],"helpers/parse-args-schema.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@rxdi/core"),r=require("graphql"),t=require("../app/app.tokens"),s=require("./parse-ast"),a=new Map;exports.buildArgumentsSchema=((p,n)=>{const o=p.$resolvers[n].args||{};let l={};const u=e.Container.get(t.TypesToken);return Object.keys(o).forEach(e=>{const t=o[e].replace("!","");if(u.has(t)){let s=new r.GraphQLInputObjectType({name:t,fields:()=>u.get(t)});return a.has(t)&&(s=a.get(t)),a.set(t,s),void(l=o[e].includes("!")?{payload:{type:new r.GraphQLNonNull(s)}}:{payload:{type:s}})}l[e]=s.ParseArgs(o[e])}),l});
},{"../app/app.tokens":"app/app.tokens.ts","./parse-ast":"helpers/parse-ast.ts"}],"helpers/dynamic-schema/mutators/build-resolvers.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@gapi/core"),r=require("@rxdi/core"),t=require("../../get-first-item"),s=require("../../isFunction"),o=require("../../lazy-types"),i=require("../../parse-args-schema");function a(a,c,n){Object.keys(a.$resolvers).forEach(p=>{const l=a.$resolvers[p].type,y=(a.$resolvers[p].method||"query").toLocaleLowerCase(),u=a.$resolvers[p].deps||[];if(!n[l])throw new Error(`Missing type '${l}', Available types: '${Object.keys(c).toString()}'`);let d=a.$resolvers[p].resolve;!d||s.isFunction(d)||Array.isArray(d)||(d=t.getFirstItem(d));const g=d;d=s.isFunction(d)?d:()=>g,Array.from(o.lazyTypes.keys()).forEach(e=>{Object.keys(o.lazyTypes.get(e)).forEach(r=>{n[e].getFields()[r].type=n[e]})}),r.Container.get(e.BootstrapService).Fields[y][p]={type:n[l],method_name:p,args:i.buildArgumentsSchema(a,p),public:!0,method_type:y,target:(e=>e.map(({provide:e,map:t})=>({container:r.Container.get(e),provide:e,map:t})).reduce((e,r)=>Object.assign({},e,{[r.map]:r.container}),{}))(u),resolve:d}})}exports.buildResolvers=a;
},{"../../get-first-item":"helpers/get-first-item.ts","../../isFunction":"helpers/isFunction.ts","../../lazy-types":"helpers/lazy-types.ts","../../parse-args-schema":"helpers/parse-args-schema.ts"}],"helpers/parse-types.schema.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(r){o(r)}}function p(e){try{s(n.throw(e))}catch(r){o(r)}}function s(e){e.done?i(e.value):new t(function(r){r(e.value)}).then(a,p)}s((n=n.apply(e,r||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const r=require("@rxdi/core"),t=require("graphql"),n=require("rxjs"),i=require("./lazy-types");function o(o,a,p,s,u){let c;"string"!==o&&"String"!==o||(c={type:t.GraphQLString}),"boolean"!==o&&"Boolean"!==o||(c={type:t.GraphQLString}),"number"!==o&&"Number"!==o||(c={type:t.GraphQLInt}),"string[]"!==o&&"String[]"!==o&&"[String]"!==o||(c={type:new t.GraphQLList(t.GraphQLString)}),"boolean[]"!==o&&"Boolean[]"!==o&&"[Boolean]"!==o||(c={type:new t.GraphQLList(t.GraphQLString)}),"number[]"!==o&&"Number[]"!==o&&"[Number]"!==o||(c={type:new t.GraphQLList(t.GraphQLInt)});const l=o.replace("(","").replace(")","").replace("!","").replace("[","").replace("]","");if(p===l&&(i.lazyTypes.set(p,Object.assign({},i.lazyTypes.get(p),{[a]:l})),c={type:u[p]}),!c)throw new Error(`Wrong plugged type ${o}`);return c.resolve=function(...t){return e(this,void 0,void 0,function*(){let e=t[0][a];for(const i of s)e=yield r.Container.get(i)(n.of(e),t[0],t[1],t[2],t[3]),n.isObservable(e)&&(e=yield e.toPromise());return e})},c}exports.ParseTypesSchema=o;
},{"./lazy-types":"helpers/lazy-types.ts"}],"helpers/dynamic-schema/mutators/build-types.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@rxdi/core"),t=require("graphql"),n=require("../../../app/app.tokens"),r=require("../../parse-types.schema");function o(e,t,n){const r=n.find(t=>t.map===e);if(!r.module[t])throw new Error(`Missing method ${t} inside ${r.file}`);return r.module[t]}function s(t,n,r){const s=o(t,n,r);return{token:new e.InjectionToken(e.createUniqueHash(`${s}`)),interceptor:s}}function i(e,t,n){let r="(",o=")";t.includes("{")&&(r="{",o="}");const i=t.split(r);let c;if(t.includes("@"))c=i[1].replace(o,"").split("@");else{const e=i[1].replace(o,"").split(n);for(let t=e.length;t-- >1;)e.splice(t,0,n);c=e}const l=(c=c.filter(e=>!!e))[0],p=c[1].replace(/ +?/g,""),{token:a,interceptor:u}=s(l,p,e);return{token:a,interceptor:u}}function c(t=[],n){return t.map(t=>{const[r]=n.filter(e=>e.includes(t.map));if(r){const n=r.replace(/[^\w\s]/gi,"").replace(/ +?/g,""),o=t.module[n];if(!o)throw new Error(`Missing method ${n} inside ${t.file}`);return{symbol:t.map,token:new e.InjectionToken(e.createUniqueHash(`${o}`)),module:t.module,method:o,injector:n}}}).filter(e=>!!e)}function l(o,s,l){Object.keys(o.$types).forEach(p=>{if(s[p])return;const a=o.$types[p];Object.keys(a).forEach(t=>{s[p]=s[p]||{};let l=a[t];const u=[];if(o.$externals){const[t]=o.$externals.map(e=>e.map).filter(e=>l.includes(e));if(t){const r=[...new Set(l.split("=>").map(e=>e.replace(/ +?/g,"").trim()))];if(r.length>2){const t=r.slice(1,r.length);for(const n of c(o.$externals,t))e.Container.set(n.token,n.method),u.push(n.token)}else{const{token:n,interceptor:r}=i(o.$externals,l,t);e.Container.set(n,r),u.push(n)}l=Object.keys(n.Roots).map(e=>{const t=Object.keys(n.Roots[e]).filter(e=>l.includes(e));if(t.length)return t[0]}).filter(e=>!!e)[0]}}s[p][t]=r.ParseTypesSchema(l,t,p,u,s)}),l[p]=new t.GraphQLObjectType({name:p,fields:()=>s[p]})})}exports.buildTypes=l;
},{"../../../app/app.tokens":"app/app.tokens.ts","../../parse-types.schema":"helpers/parse-types.schema.ts"}],"helpers/transpiler-cache.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.transpilerCache=new Map;
},{}],"helpers/typescript.builder.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("child_process");exports.TranspileTypescript=((s=[],r)=>s.length?new Promise(o=>{const p=e.spawn("npx",["gapi","build","--glob",`${s.toString()}`,"--outDir",r]);p.stderr.pipe(process.stderr),p.on("close",e=>o(e))}):Promise.resolve(0)),exports.TranspileTypescriptParcel=((s=[],r)=>s.length?new Promise(o=>{const p=e.spawn("npx",["parcel","build",`${s.join(" ")}`,"--out-dir",r]);p.stdout.pipe(process.stdout),p.stderr.pipe(process.stderr),p.on("close",e=>o(e))}):Promise.resolve(0));
},{}],"helpers/transpile-and-load.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))(function(i,s){function c(e){try{o(n.next(e))}catch(r){s(r)}}function a(e){try{o(n.throw(e))}catch(r){s(r)}}function o(e){e.done?i(e.value):new t(function(r){r(e.value)}).then(c,a)}o((n=n.apply(e,r||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const r=require("path"),t=require("./transpiler-cache"),n=require("./typescript.builder"),i=require("clear-module");function s(e,t){return r.join(process.cwd(),t,r.parse(r.join(process.cwd(),t,e)).base.replace("ts","js"))}function c(e){return e="."===e[0]?e.substr(1):e,r.isAbsolute(e)?e=e.replace(process.cwd(),""):e}function a(r,a){return e(this,void 0,void 0,function*(){if(r=c(r),t.transpilerCache.has(r))return t.transpilerCache.get(r);yield n.TranspileTypescript([r],a);const e=s(r,a);i(e);const o=require(e);return t.transpilerCache.set(r,o),o})}function o(t,i){return e(this,void 0,void 0,function*(){return yield n.TranspileTypescript(t.map(e=>e.file).map(e=>c(e)),i),t.map(e=>Object.assign({},e,{transpiledFile:r.join(process.cwd(),i,r.parse(e.file).base.replace("ts","js"))}))})}exports.TranspileAndLoad=a,exports.TranspileAndGetAll=o;
},{"./transpiler-cache":"helpers/transpiler-cache.ts","./typescript.builder":"helpers/typescript.builder.ts"}],"helpers/dynamic-schema/mutators/build-externals.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function u(e){try{l(r.next(e))}catch(t){o(t)}}function a(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(u,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@rxdi/core"),n=require("path"),r=require("../../transpile-and-load");function i(i){return e(this,void 0,void 0,function*(){const e=yield r.TranspileAndGetAll(i.$externals,"./.gj/out");return i.$externals=e.map(e=>{if(e.file.includes(".ts"))e.module=require(e.transpiledFile);else{const t=require("esm")(module)(n.join(process.cwd(),e.file));e.module=t.default||t}return t.Container.reset(e.map),t.Container.remove(e.map),t.Container.set(e.map,e.module),e}),i.$externals})}exports.buildExternals=i;
},{"../../transpile-and-load":"helpers/transpile-and-load.ts"}],"helpers/advanced-schema.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function u(e){try{c(n.next(e))}catch(t){i(t)}}function a(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(u,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("../helpers/dynamic-schema/mutators/build-arguments"),r=require("../helpers/dynamic-schema/mutators/build-resolvers"),n=require("../helpers/dynamic-schema/mutators/build-types"),s=require("./dynamic-schema/mutators/build-externals");function i(i){return e(this,void 0,void 0,function*(){const e={},u={};return i.$args=i.$args||{},i.$types=i.$types||{},i.$externals&&i.$externals.length&&(i.$externals=yield s.buildExternals(i)),t.buildArguments(i),n.buildTypes(i,e,u),r.buildResolvers(i,e,u),u})}exports.MakeAdvancedSchema=i;
},{"../helpers/dynamic-schema/mutators/build-arguments":"helpers/dynamic-schema/mutators/build-arguments.ts","../helpers/dynamic-schema/mutators/build-resolvers":"helpers/dynamic-schema/mutators/build-resolvers.ts","../helpers/dynamic-schema/mutators/build-types":"helpers/dynamic-schema/mutators/build-types.ts","./dynamic-schema/mutators/build-externals":"helpers/dynamic-schema/mutators/build-externals.ts"}],"helpers/args-extractors.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.includes=(e=>process.argv.toString().includes(e)),exports.nextOrDefault=((e,r=!0,s=(e=>e))=>{if(process.argv.toString().includes(e)){const t=process.argv[process.argv.indexOf(e)+1];return t?t.includes("--")?r:s(t):r}return r});
},{}],"helpers/basic-schema.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@gapi/core"),t=require("graphql");function r(r){Object.keys(r.$resolvers).forEach(o=>{const p=r.$resolvers[o],n={};Object.keys(p).forEach(e=>{const r=p[e];"string"==typeof r&&(n[e]={type:t.GraphQLString}),"number"==typeof r&&(n[e]={type:t.GraphQLInt}),"boolean"==typeof r&&(n[e]={type:t.GraphQLBoolean}),"string"!=typeof r&&r.length&&("string"==typeof r[0]&&(n[e]={type:new t.GraphQLList(t.GraphQLString)}),"number"==typeof r[0]&&(n[e]={type:new t.GraphQLList(t.GraphQLInt)}),"boolean"==typeof r[0]&&(n[e]={type:new t.GraphQLList(t.GraphQLBoolean)}))}),e.Container.get(e.BootstrapService).Fields.query[o]={type:new t.GraphQLObjectType({name:`${o}_type`,fields:()=>n}),args:{},method_name:o,public:!0,method_type:"query",target:()=>({}),resolve:"function"==typeof p?p:()=>p}})}exports.MakeBasicSchema=r;
},{}],"helpers/basic.template.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.basicTemplate={$mode:"basic",$types:{user:{pesho:"string"}},$schema:"./schema.graphql",$resolvers:{findUser:{gosho:"omg",pesho:515151,pesho2:515151,pesho3:515151,dadadada:515151,pesho4:515151,pesho5:[515151],pesho6:["515151"]},findUser2:{gosho:"omg",pesho:22,pesho2:515151,pesho3:515151,pesho4:515151,pesho5:515151}}};
},{}],"helpers/component.parser.ts":[function(require,module,exports) {
"use strict";var n=this&&this.__awaiter||function(n,e,t,o){return new(t||(t=Promise))(function(i,r){function s(n){try{p(o.next(n))}catch(e){r(e)}}function c(n){try{p(o.throw(n))}catch(e){r(e)}}function p(n){n.done?i(n.value):new t(function(e){e(n.value)}).then(s,c)}p((o=o.apply(n,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("fs"),t=require("path"),o=require("util"),i=require("./typescript.builder");function r(i=""){return n(this,void 0,void 0,function*(){if(!i||i&&!i.includes("💉"))return;const n=`${i}`;i=i.replace("💉","");let r=t.join(process.cwd(),i),s=r;return r=t.join(process.cwd(),"node_modules",i),(yield o.promisify(e.exists)(r))&&(s=`./node_modules/${i}`),{originalPath:n,filePath:r,transpilerPath:s,newPath:t.join(process.cwd(),"components",i.replace(t.basename(i),"")),link:`http://0.0.0.0:9000/components/${t.basename(i).replace("ts","js")}`}})}function s(e){return n(this,void 0,void 0,function*(){return(yield Promise.all([].concat(...Object.keys(e).map(n=>e[n].components)).filter(n=>!!n).map(n=>r(n.link)))).filter(n=>!!n)})}function c(n,e){return Object.keys(n).forEach(t=>{n[t].components&&(n[t].components=n[t].components.map(n=>{const t=e.find(e=>e.originalPath===n.link);return t?(n.link=t.link,n):n}))}),n}function p(e){return n(this,void 0,void 0,function*(){const n=yield s(e);for(const{transpilerPath:e}of n)yield i.TranspileTypescriptParcel([e],t.join(process.cwd(),"components"));return c(e,n),e})}function u(e){return n(this,void 0,void 0,function*(){return Promise.all(e.map(e=>n(this,void 0,void 0,function*(){return yield r(e.link)})))})}function a(e){return n(this,void 0,void 0,function*(){const n=yield u(e);for(const e of n)yield i.TranspileTypescriptParcel([e.transpilerPath],t.join(process.cwd(),"components"));return n})}exports.transpileComponent=r,exports.mapComponentsPath=s,exports.modifyViewsConfig=c,exports.transpileComponentsForViews=p,exports.predictConfig=u,exports.transpileComponentsInit=a;
},{"./typescript.builder":"helpers/typescript.builder.ts"}],"helpers/is-runner-installed.ts":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function u(t){try{s(i.next(t))}catch(e){o(e)}}function c(t){try{s(i.throw(t))}catch(e){o(e)}}function s(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(u,c)}s((i=i.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("child_process"),n=require("util");function i(i){return t(this,void 0,void 0,function*(){let t;try{t=!(yield n.promisify(e.exec)(i)).stderr}catch(r){t=!1}return t})}function r(){return t(this,void 0,void 0,function*(){return yield i("parcel help")})}function o(){return t(this,void 0,void 0,function*(){return yield i("gapi daemon status")})}exports.isParcelInstalled=r,exports.isGapiInstalled=o;
},{}],"helpers/set-config.ts":[function(require,module,exports) {
"use strict";var i=this&&this.__awaiter||function(i,e,t,n){return new(t||(t=Promise))(function(r,o){function s(i){try{u(n.next(i))}catch(e){o(e)}}function c(i){try{u(n.throw(i))}catch(e){o(e)}}function u(i){i.done?r(i.value):new t(function(e){e(i.value)}).then(s,c)}u((n=n.apply(i,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("fs"),t=require("js-yaml"),n=require("path"),r=require("util"),o=require("./typescript.builder");function s(s){return i(this,void 0,void 0,function*(){let c;try{c=require("esm")(module)(n.join(process.cwd(),`${s}.js`))}catch(u){}if(yield r.promisify(e.exists)(`./${s}.yml`)){const i=e.readFileSync(`./${s}.yml`,{encoding:"utf-8"});c=t.load(i)}if(yield r.promisify(e.exists)(`./${s}.ts`)){const t=yield r.promisify(e.exists)("./.gj/config.temp"),y=t=>i(this,void 0,void 0,function*(){yield o.TranspileTypescript([`/${s}.ts`],"./.gj"),yield r.promisify(e.writeFile)("./.gj/config.temp",t.mtime.toISOString(),{encoding:"utf-8"})}),d=yield r.promisify(e.stat)(`./${s}.ts`);if(t){const i=yield r.promisify(e.readFile)("./.gj/config.temp",{encoding:"utf-8"});new Date(i).toISOString()!==d.mtime.toISOString()&&(yield y(d))}else yield y(d);c=require(n.join(process.cwd(),"./.gj",`${s}.js`));try{yield r.promisify(e.unlink)(n.join("./.gj",`${s}.js.map`))}catch(u){}}try{c=JSON.parse(yield r.promisify(e.readFile)(n.join(process.cwd(),`${s}.json`),{encoding:"utf-8"}))}catch(u){}return c})}exports.getConfig=s;
},{"./typescript.builder":"helpers/typescript.builder.ts"}],"helpers/traverse-map.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.traverseMap=[];
},{}],"helpers/is-invalid-path.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("path");function t(t,r={}){if(""===t||"string"!=typeof t)return!0;const n=r.extended?32767:260;if("string"!=typeof t||t.length>n-12)return!0;const s=e.parse(t).root;return s&&(t=t.slice(s.length)),r.file?/[<>:"\/\\|?*]/.test(t):/[<>:"|?*]/.test(t)}exports.isInValidPath=t;
},{}],"helpers/load-yml.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function u(e){try{a(i.next(e))}catch(t){o(t)}}function c(e){try{a(i.throw(e))}catch(t){o(t)}}function a(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(u,c)}a((i=i.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("fs"),n=require("js-yaml"),i=require("util");function r(r){return e(this,void 0,void 0,function*(){return n.load(yield i.promisify(t.readFile)(r,{encoding:"utf-8"}))})}exports.loadYml=r;
},{}],"helpers/load-file.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,r,i,n){return new(i||(i=Promise))(function(t,s){function a(e){try{o(n.next(e))}catch(r){s(r)}}function l(e){try{o(n.throw(e))}catch(r){s(r)}}function o(e){e.done?t(e.value):new i(function(r){r(e.value)}).then(a,l)}o((n=n.apply(e,r||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const r=require("fs"),i=require("path"),n=require("util"),t=require("../app/app.tokens"),s=require("./is-invalid-path"),a=require("./load-yml"),l=require("./transpile-and-load"),o=require("./traverse-map"),u=require("clear-module"),c=require("@rxdi/core");function d(d){return e(this,void 0,void 0,function*(){let e;if(s.isInValidPath(d))return d;if(!(yield n.promisify(r.exists)(d))){const e=o.traverseMap[o.traverseMap.length-1];e&&(d=i.join(process.cwd(),e.parent,d.replace(process.cwd(),"")),(yield n.promisify(r.exists)(d))||(d=i.join(process.cwd(),e.parent,i.basename(d))))}d.includes(".yml")?e=yield a.loadYml(d):d.includes(".json")?(d=i.normalize(i.join(process.cwd(),d)),u(d),e=require(d)):e=d.includes(".html")||d.includes(".graphql")||d.includes(".gql")?yield n.promisify(r.readFile)(d,{encoding:"utf-8"}):c.Container.get(t.IsBundlerInstalled).gapi&&d.includes(".ts")||d.includes(".js")?yield l.TranspileAndLoad(d,"./.gj/out"):require("esm")(module,{cache:!1})(d);const p=d.substring(0,d.lastIndexOf("/")).replace(process.cwd(),"");return o.traverseMap.push({parent:p,path:d}),e})}exports.loadFile=d;
},{"../app/app.tokens":"app/app.tokens.ts","./is-invalid-path":"helpers/is-invalid-path.ts","./load-yml":"helpers/load-yml.ts","./transpile-and-load":"helpers/transpile-and-load.ts","./traverse-map":"helpers/traverse-map.ts"}],"helpers/traverse/omg.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function c(e){try{s(n.next(e))}catch(t){i(t)}}function u(e){try{s(n.throw(e))}catch(t){i(t)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(c,u)}s((n=n.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@rxdi/core"),r=require("path"),n=require("../load-file");function o(t){return e(this,void 0,void 0,function*(){return yield Promise.all(t.map(t=>e(this,void 0,void 0,function*(){return i(t)})))})}function i(t){return e(this,void 0,void 0,function*(){return"object"!=typeof t||null===t?t:Array.isArray(t)?o(t):u(t)})}function c(e){return e.replace("💉","")}function u(o){return e(this,void 0,void 0,function*(){const e={};let u;const s={};for(const[d,l]of Object.entries(o))if("string"==typeof l&&l.includes("💉")){u=`${c(l)}`;const o=yield n.loadFile(r.join(process.cwd(),u));e[d]=yield i(o),s[d]=u;try{t.Container.get("watcher").add(r.join(process.cwd(),u))}catch(a){}Object.defineProperty(e,"_meta",{value:s,enumerable:!1,writable:!0})}else e[d]=yield i(l);return e})}exports.deepArray=o,exports.deep=i,exports.replaceInjectSymbol=c,exports.deepObject=u,exports.meta=new Map;
},{"../load-file":"helpers/load-file.ts"}],"helpers/is-array.ts":[function(require,module,exports) {
"use strict";function e(e){return"[object Array]"===Object.prototype.toString.call(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isArray=e;
},{}],"helpers/traverse/traverse.ts":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function c(t){try{s(n.next(t))}catch(e){o(e)}}function u(t){try{s(n.throw(t))}catch(e){o(e)}}function s(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(c,u)}s((n=n.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../is-array");function r(r,o){return t(this,void 0,void 0,function*(){e.isArray(r)?yield i(r,o):"object"==typeof r&&null!==r&&(yield n(r,o))})}function n(e,n){return t(this,void 0,void 0,function*(){for(const[t,i]of Object.entries(e))if(e.hasOwnProperty(t)){if(yield n(t,i))break;yield r(e[t],n)}})}function i(e,n){return t(this,void 0,void 0,function*(){for(const t of e)return yield r(t,n)})}exports.traverse=r,exports.traverseObject=n,exports.traverseArray=i;
},{"../is-array":"helpers/is-array.ts"}],"helpers/react-to-changes.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,n,i,t){return new(i||(i=Promise))(function(r,o){function a(e){try{s(t.next(e))}catch(n){o(n)}}function c(e){try{s(t.throw(e))}catch(n){o(n)}}function s(e){e.done?r(e.value):new i(function(n){n(e.value)}).then(a,c)}s((t=t.apply(e,n||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const n=require("@gapi/core"),i=require("path"),t=require("../app/app.tokens"),r=require("./advanced-schema"),o=require("./basic-schema"),a=require("./component.parser"),c=require("./get-first-item"),s=require("./lazy-types"),l=require("./load-file"),d=require("./transpiler-cache"),u=require("./traverse/omg"),p=require("./traverse/traverse"),m=require("./watch-bundles");function f(e,n){return Object.keys(n).find(t=>n[t]===e||i.basename(n[t]).includes(i.basename(e)))}function v(e){return`.${e.replace(process.cwd(),"")}`}let h;function g(i,g){return e(this,void 0,void 0,function*(){if(h)return console.log(`✋  Bundle is updating previews change! Unable to update ${i}`),void(h=!1);const y=Date.now();console.log(`💡  Bundle changed: ${i}`),h=!0;try{d.transpilerCache.delete(i.replace(process.cwd(),"")),d.transpilerCache.delete(i.replace(process.cwd(),"").replace(".",""));const t=yield l.loadFile(i);let a;g._meta&&(a=f(v(i),g._meta)),m.configWatchers.filter(e=>i.includes(e)).length?g=yield u.deep(t):g._meta&&a?g[a]=yield u.deep(t):g=yield function(n,i,t){return e(this,void 0,void 0,function*(){return yield p.traverse(t,(t,r)=>e(this,void 0,void 0,function*(){if("object"==typeof r&&r._meta){const e=f(v(n),r._meta);if(e)return r[e]=yield u.deep(c.getFirstItem(i)),!0}return!1})),t})}(i,t,g),s.lazyTypes.clear(),n.Container.get(n.BootstrapService).Fields={mutation:{},query:{},subscription:{}},"basic"===g.$mode&&(yield o.MakeBasicSchema(g)),"advanced"===g.$mode&&(yield r.MakeAdvancedSchema(g)),n.Container.get(n.ApolloService).init()}catch(C){console.error(C)}h=!1,g.$views&&(g.$views=yield a.transpileComponentsForViews(g.$views)),g.$components&&(g.$components=(yield a.transpileComponentsInit(g.$components)).map(e=>e&&e.link?e.link:e)),n.Container.reset(t.Config),n.Container.remove(t.Config),n.Container.set(t.Config,g),g.$views&&n.Container.get(n.PubSubService).publish("listenForChanges",g.$views),n.Container.reset("main-config-compiled"),n.Container.remove("main-config-compiled"),n.Container.set("main-config-compiled",g),console.log(`📦  Bundle realoaded! ${Date.now()-y}ms`,i)})}exports.reactToChanges=g;
},{"../app/app.tokens":"app/app.tokens.ts","./advanced-schema":"helpers/advanced-schema.ts","./basic-schema":"helpers/basic-schema.ts","./component.parser":"helpers/component.parser.ts","./get-first-item":"helpers/get-first-item.ts","./lazy-types":"helpers/lazy-types.ts","./load-file":"helpers/load-file.ts","./transpiler-cache":"helpers/transpiler-cache.ts","./traverse/omg":"helpers/traverse/omg.ts","./traverse/traverse":"helpers/traverse/traverse.ts","./watch-bundles":"helpers/watch-bundles.ts"}],"helpers/watch-bundles.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,c){function i(e){try{a(o.next(e))}catch(t){c(t)}}function s(e){try{a(o.throw(e))}catch(t){c(t)}}function a(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,s)}a((o=o.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@rxdi/core"),n=require("chokidar"),o=require("./react-to-changes");function r(r,c){const i=n.watch([...new Set(r),...exports.configWatchers.map(e=>`./${e}`)],{ignored:e=>e.includes("node_modules")}).on("change",t=>e(this,void 0,void 0,function*(){return o.reactToChanges(t,c)}));t.Container.set("watcher",i)}exports.configWatchers=["gj.yml","gj.json","gj.js","gj.ts"],exports.watchBundles=r;
},{"./react-to-changes":"helpers/react-to-changes.ts"}],"app/client/types/components.type.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("graphql");exports.ComponentsType=new e.GraphQLObjectType({name:"ComponentsType",fields:{link:{type:e.GraphQLString},selector:{type:e.GraphQLString}}});
},{}],"app/client/types/client-view.type.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("graphql"),r=require("./components.type");exports.ClientViewType=new e.GraphQLObjectType({name:"ClientViewType",fields:()=>({html:{type:e.GraphQLString},lhtml:{type:e.GraphQLString},rendering:{type:new e.GraphQLEnumType({name:"ClientViewRenderingEnum",values:{server:{value:"server"},client:{value:"client"}}}),resolve:e=>e.rendering?"server":"client"},components:{type:new e.GraphQLList(r.ComponentsType)},name:{type:e.GraphQLString},policy:{type:e.GraphQLString},query:{type:e.GraphQLString},props:{type:new e.GraphQLList(e.GraphQLString)},output:{type:e.GraphQLString}})});
},{"./components.type":"app/client/types/components.type.ts"}],"app/client/types/client.type.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("graphql"),t=require("./client-view.type"),p=require("./components.type");exports.ClientType=new e.GraphQLObjectType({name:"ClientType",fields:{components:{type:new e.GraphQLList(p.ComponentsType)},views:{type:new e.GraphQLList(t.ClientViewType)},schema:{type:e.GraphQLString}}});
},{"./client-view.type":"app/client/types/client-view.type.ts","./components.type":"app/client/types/components.type.ts"}],"app/client/client.controller.ts":[function(require,module,exports) {
"use strict";var e,t,n=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,c=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(c=(o<3?r(c):o>3?r(t,n,c):r(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function c(e){try{a(i.next(e))}catch(t){o(t)}}function s(e){try{a(i.throw(e))}catch(t){o(t)}}function a(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(c,s)}a((i=i.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const o=require("@gapi/core"),c=require("../app.tokens"),s=require("./types/client.type");exports.viewsToArray=(e=>Object.keys(e).reduce((t,n)=>[...t,Object.assign({},e[n],{name:n})],[]));const a=e=>t=>({components:t.$components,views:exports.viewsToArray(e||t.$views),schema:o.printSchema(o.Container.get(o.BootstrapService).schema)});let u=class{constructor(e){this.pubsub=e}listenForChanges(e){return r(this,void 0,void 0,function*(){return a(e)(o.Container.get("main-config-compiled"))})}clientReady(){return r(this,void 0,void 0,function*(){return a()(o.Container.get("main-config-compiled"))})}};n([o.Type(s.ClientType),o.Subscribe(o.withFilter(function(e){return e.pubsub.asyncIterator("listenForChanges")},function(e,t,n,i){return 100===i.clientid.length+i.clientid.length&&n.clientId===i.clientid})),o.Subscription({clientId:{type:new o.GraphQLNonNull(o.GraphQLString)}}),i("design:type",Function),i("design:paramtypes",["function"==typeof(e=void 0!==c.IConfigViews&&c.IConfigViews)?e:Object]),i("design:returntype",Promise)],u.prototype,"listenForChanges",null),n([o.Type(s.ClientType),o.Mutation(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],u.prototype,"clientReady",null),u=n([o.Controller({guards:[],type:[]}),i("design:paramtypes",["function"==typeof(t=void 0!==o.PubSubService&&o.PubSubService)?t:Object])],u),exports.ClientController=u;
},{"../app.tokens":"app/app.tokens.ts","./types/client.type":"app/client/types/client.type.ts"}],"app/client/client.module.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__decorate||function(e,t,r,o){var l,c=arguments.length,n=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,o);else for(var i=e.length-1;i>=0;i--)(l=e[i])&&(n=(c<3?l(n):c>3?l(t,r,n):l(t,r))||n);return c>3&&n&&Object.defineProperty(t,r,n),n};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@rxdi/core"),r=require("./client.controller");let o=class{};o=e([t.Module({controllers:[r.ClientController]})],o),exports.ClientModule=o;
},{"./client.controller":"app/client/client.controller.ts"}],"app/core/services/serve-components.service.ts":[function(require,module,exports) {
"use strict";var e,t=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,c=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(c=(o<3?i(c):o>3?i(t,r,c):i(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function c(e){try{s(n.next(e))}catch(t){o(t)}}function a(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(c,a)}s((n=n.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const o=require("@rxdi/core"),c=require("@rxdi/hapi"),a=require("hapi"),s=require("../../../helpers/args-extractors");let u=class{constructor(e){this.server=e}register(){return i(this,void 0,void 0,function*(){s.includes("--client")&&(this.server.route({method:"GET",path:"/components/{param*}",handler:{directory:{path:`${process.cwd()}/components`,index:["index.html","default.html"]}}}),this.server.route({method:"GET",path:"/{param*}",handler:{directory:{path:__dirname,redirectToSlash:!0,listing:!1,index:["index.html"]}}}))})}};u=t([o.Plugin(),n(0,o.Inject(c.HAPI_SERVER)),r("design:paramtypes",["function"==typeof(e=void 0!==a.Server&&a.Server)?e:Object])],u),exports.ServeComponents=u;
},{"../../../helpers/args-extractors":"helpers/args-extractors.ts"}],"app/core/core.module.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__decorate||function(e,t,r,o){var c,s=arguments.length,n=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,o);else for(var i=e.length-1;i>=0;i--)(c=e[i])&&(n=(s<3?c(n):s>3?c(t,r,n):c(t,r))||n);return s>3&&n&&Object.defineProperty(t,r,n),n};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@rxdi/core"),r=require("./services/serve-components.service");let o=class{};o=e([t.Module({plugins:[r.ServeComponents]})],o),exports.CoreModule=o;
},{"./services/serve-components.service":"app/core/services/serve-components.service.ts"}],"app/app.module.ts":[function(require,module,exports) {
"use strict";var e=this&&this.__decorate||function(e,r,t,n){var i,s=arguments.length,o=s<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,r,t,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(r,t,o):i(r,t))||o);return s>3&&o&&Object.defineProperty(r,t,o),o},r=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(r){s(r)}}function a(e){try{l(n.throw(e))}catch(r){s(r)}}function l(e){e.done?i(e.value):new t(function(r){r(e.value)}).then(o,a)}l((n=n.apply(e,r||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@gapi/core"),n=require("@gapi/voyager"),i=require("fs"),s=require("path"),o=require("util"),a=require("../helpers/advanced-schema"),l=require("../helpers/args-extractors"),c=require("../helpers/basic-schema"),u=require("../helpers/basic.template"),d=require("../helpers/component.parser"),p=require("../helpers/dynamic-schema/mutators/build-externals"),h=require("../helpers/is-runner-installed"),m=require("../helpers/set-config"),f=require("../helpers/transpile-and-load"),g=require("../helpers/traverse-map"),y=require("../helpers/traverse/omg"),v=require("../helpers/watch-bundles"),q=require("./app.tokens"),$=require("./client/client.module"),x=require("./core/core.module");let b=class{};b=e([t.Module({imports:[x.CoreModule,n.VoyagerModule.forRoot(),$.ClientModule],providers:[{provide:q.TypesToken,useValue:new Map},{provide:q.IsBundlerInstalled,useValue:{parcel:!1,gapi:!1}},{provide:t.SCHEMA_OVERRIDE,useFactory:()=>e=>{let r;try{const e=JSON.parse(i.readFileSync(s.join(process.cwd(),"gj.json"),{encoding:"utf-8"}));e.$schema=e.$schema||l.nextOrDefault("--schema",!1),e.$schema&&(r=i.readFileSync(e.$schema,{encoding:"utf-8"}),r=t.buildSchema(r))}catch(c){}const n=[r,e].filter(e=>!!e);let a;return a=1===n.length?e:t.mergeSchemas({schemas:n}),l.includes("--verbose")&&console.log(`\nSchema:\n${t.printSchema(a)}\n                  `),process.argv.toString().includes("--generate")&&o.promisify(i.writeFile)("./schema.graphql",t.printSchema(a),{encoding:"utf-8"}).then(()=>{console.log("Schema created!"),process.exit(0)}),a}},{provide:q.Config,useFactory:()=>r(this,void 0,void 0,function*(){let e=yield m.getConfig(l.nextOrDefault("--config","graphqj-config"));return e||(e=yield m.getConfig("gj")),e||(e=u.basicTemplate),e.default||e})},{provide:"Run",deps:[q.Config,t.GRAPHQL_PLUGIN_CONFIG,q.IsBundlerInstalled],lazy:!0,useFactory:(e,n,u)=>r(this,void 0,void 0,function*(){e=yield e,e=yield y.deep(e),u.gapi=yield h.isGapiInstalled(),e.$externals=e.$externals||[],e.$externals&&e.$externals.length&&(e.$externals=yield p.buildExternals(e));const r=s.join(process.cwd(),e.$directives||"");let m;return(yield o.promisify(i.exists)(r))&&r!==process.cwd()&&(m=r.includes(".ts")?yield f.TranspileAndLoad(e.$directives.replace(".",""),"./.gj/out"):require("esm")(module)(r),n.directives=(yield Promise.all(Object.keys(m).map(e=>"function"==typeof m[e]?m[e]():null))).filter(e=>!!e)),"basic"===e.$mode&&(yield c.MakeBasicSchema(e)),"advanced"===e.$mode&&(yield a.MakeAdvancedSchema(e)),e.$views&&process.argv.push("--hot-reload","--client"),l.includes("--hot-reload")&&(e.$externals.forEach(e=>g.traverseMap.push({parent:null,path:e.file})),v.watchBundles(g.traverseMap.map(e=>e.path),e)),e.$components=e.$components||[],e.$components.length&&(e.$components=((yield d.predictConfig(e.$components))||[]).map(e=>e.link)),t.Container.set("main-config-compiled",e),console.log("You can extract this schema by running --generate command"),!0})}]})],b),exports.AppModule=b;
},{"../helpers/advanced-schema":"helpers/advanced-schema.ts","../helpers/args-extractors":"helpers/args-extractors.ts","../helpers/basic-schema":"helpers/basic-schema.ts","../helpers/basic.template":"helpers/basic.template.ts","../helpers/component.parser":"helpers/component.parser.ts","../helpers/dynamic-schema/mutators/build-externals":"helpers/dynamic-schema/mutators/build-externals.ts","../helpers/is-runner-installed":"helpers/is-runner-installed.ts","../helpers/set-config":"helpers/set-config.ts","../helpers/transpile-and-load":"helpers/transpile-and-load.ts","../helpers/traverse-map":"helpers/traverse-map.ts","../helpers/traverse/omg":"helpers/traverse/omg.ts","../helpers/watch-bundles":"helpers/watch-bundles.ts","./app.tokens":"app/app.tokens.ts","./client/client.module":"app/client/client.module.ts","./core/core.module":"app/core/core.module.ts"}],"helpers/self-child.ts":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("child_process"),s=require("rxjs");exports.SelfChild=(r=>new s.Observable(s=>{const o=[];o.push("--config"),o.push(r);const t=e.spawn("gj",o);return t.stdout.pipe(process.stdout),t.stderr.pipe(process.stderr),process.on("exit",()=>t.kill()),s.next(t),()=>{s.complete(),t.kill(),console.log(`Child process: ${t.pid} killed`)}}));
},{}],"main.ts":[function(require,module,exports) {
"use strict";var n=this&&this.__awaiter||function(n,e,r,t){return new(r||(r=Promise))(function(o,i){function s(n){try{l(t.next(n))}catch(e){i(e)}}function a(n){try{l(t.throw(n))}catch(e){i(e)}}function l(n){n.done?o(n.value):new r(function(e){e(n.value)}).then(s,a)}l((t=t.apply(n,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@gapi/core"),r=require("@rxdi/core"),t=require("chokidar"),o=require("fs"),i=require("util"),s=require("./app/app.module"),a=require("./helpers/args-extractors"),l=require("./helpers/component.parser"),c=require("./helpers/get-first-item"),u=require("./helpers/self-child"),d=require("./helpers/set-config"),p=require("./helpers/transpile-and-load");if(a.includes("--watch")){let e;const r=a.nextOrDefault("--config");if(!o.existsSync(r))throw new Error(`File missing ${r}`);const i=n=>n.includes("node_modules");t.watch(r,{ignored:i}).on("change",()=>n(this,void 0,void 0,function*(){e&&e.unsubscribe(),e=u.SelfChild(r).subscribe(n=>{console.log("Child process started: ",n.pid)})})),t.watch(r,{ignored:i}).on("ready",()=>n(this,void 0,void 0,function*(){e&&e.unsubscribe(),e=u.SelfChild(r).subscribe(n=>{console.log("Child process started: ",n.pid)})}))}else if(a.includes("init"))a.includes("advanced")?i.promisify(o.writeFile)("./gj.json",'\n{\n  "$mode": "advanced",\n  "$types": {\n    "user": {\n      "name": "String",\n      "email": "String",\n      "phone": "Number",\n      "arrayOfNumbers": "Number[]",\n      "arrayOfStrings": "String[]"\n    }\n  },\n  "$resolvers": {\n    "findUser": {\n      "type": "user",\n      "resolve": {\n        "name": "Kristiyan Tachev",\n        "email": "test@gmail.com",\n        "phone": 414141,\n        "arrayOfNumbers": [515151, 412414],\n        "arrayOfStrings": ["515151", "412414"]\n      }\n    }\n  }\n}',{encoding:"utf-8"}):a.includes("es6")?i.promisify(o.writeFile)("./gj.js","\nexport default {\n  $mode: 'advanced',\n  $types: {\n    user: {\n      name: 'String',\n      email: 'String',\n      phone: 'Number',\n      arrayOfNumbers: 'Number[]',\n      arrayOfStrings: 'String[]'\n    }\n  },\n  $resolvers: {\n    findUser: {\n      type: 'user',\n      args: {\n        userId: \"String!\",\n        userId2: \"String\",\n      },\n      resolve: async (root, payload, context) => ({\n        name: 'Kristiyan Tachev',\n        email: 'test@gmail.com',\n        phone: 4141423,\n        arrayOfNumbers: [515151, 412414],\n        arrayOfStrings: ['515151', '412414']\n      })\n    }\n  }\n};\n",{encoding:"utf-8"}):a.includes("typescript")?i.promisify(o.writeFile)("./gj.ts","\nexport default {\n  $mode: 'advanced',\n  $types: {\n    user: {\n      name: 'String',\n      email: 'String',\n      phone: 'Number',\n      arrayOfNumbers: 'Number[]',\n      arrayOfStrings: 'String[]'\n    }\n  },\n  $resolvers: {\n    findUser: {\n      type: 'user',\n      args: {\n        userId: \"String!\",\n        userId2: \"String\",\n      },\n      resolve: async (root, payload: { userId: string; userId2?: string }) => ({\n        name: 'Kristiyan Tachev',\n        email: 'test@gmail.com',\n        phone: 4141423,\n        arrayOfNumbers: [515151, 412414],\n        arrayOfStrings: ['515151', '412414']\n      })\n    }\n  }\n};\n",{encoding:"utf-8"}):a.includes("yml")?i.promisify(o.writeFile)("./gj.yml",'\n$mode: advanced\n$types:\n  User:\n    name: String\n    email: String\n    phone: Number\n    arrayOfNumbers: Number[]\n    arrayOfStrings: String[]\n    arrayOfStrings2: String[]\n    users: User[]\n$args:\n  UserPayload:\n    name: String!\n    pesho: String\n\n$resolvers:\n  findUser:\n    type: User\n    args:\n      userId: UserPayload\n    resolve: !!js/function >\n      function foobar(root, payload, context, info) {\n        console.log(\'OMG\')\n        return {\n          "name": "Kristiyan Tachev",\n          "email": "test@gmail.com",\n          "phone": 414141,\n          "arrayOfNumbers": [515151, 412414],\n          "arrayOfStrings": [\'515151\', \'412414\']\n        }\n      }\n\n$views:\n\n  app:\n    html: |\n      <style>\n        .spacer {\n          flex: 1 3 auto;\n        }\n        .container {\n          display: flex;\n        }\n        ul {\n          list-style-type: none;\n          margin: 0;\n          padding: 0;\n          overflow: hidden;\n          background-color: #f3f3f3;\n          cursor: pointer;\n        }\n        li {\n          float: left;\n        }\n        li a {\n          display: block;\n          color: #666;\n          text-align: center;\n          padding: 14px 16px;\n          text-decoration: none;\n        }\n        li a:hover:not(.active) {\n          background-color: #ddd;\n        }\n        li a.active {\n          color: white;\n          background-color: #4caf50;\n        }\n        .footer {\n          position: fixed;\n          left: 0;\n          bottom: 0;\n          width: 100%;\n          background-color: #03a9f4;\n          color: white;\n          text-align: center;\n        }\n      </style>\n      <ul class="container" slot="header">\n        <li><a href="/">Home</a></li>\n        <li><a href="/about">About</a></li>\n        <li><a href="/contacts">Contacts</a></li>\n        <span class="spacer"></span>\n      </ul>\n      <div class="footer" slot="footer">\n        <p>Footer</p>\n      </div>\n\n  home:\n    query: |\n      query findUser {\n        findUser {\n          name\n          email\n          phone\n          arrayOfStrings\n        }\n      }\n    output: UserPayload\n    policy: network-only\n    html: |\n      Welcome to Home component\n      <p>Name: {findUser.name}</p>\n      <p>Email: {findUser.email}</p>\n      <p>Phone: {findUser.phone}</p>\n      {findUser.arrayOfStrings}\n      <div style="background-color: red">\n        <hamburger-component type="3dx" active=true enableBackendStatistics=true></hamburger-component>\n      </div>\n\n  about:\n    query: findUser\n    html: |\n      Welcome to About\n      <p>Name: {findUser.name}</p>\n      <p>Email: {findUser.email}</p>\n      <p>Phone: {findUser.phone}</p>\n\n  contacts:\n    html: |\n      Welcome to Contacts\n\n  not-found:\n    html: |\n      Not found\n',{encoding:"utf-8"}):i.promisify(o.writeFile)("./gj.json",'\n{\n  "$mode": "basic",\n  "$resolvers": {\n    "findUser": {\n      "name": "Kristiyan Tachev",\n      "email": "test@gmail.com",\n      "phone": 414141,\n      "arrayOfNumbers": [515151, 412414],\n      "arrayOfStrings": ["515151", "412414"]\n    }\n  }\n}\n',{encoding:"utf-8"});else{function m(){return n(this,void 0,void 0,function*(){let n;r.Container.set("pubsub-auth",{onSubConnection:n=>n,onSubOperation:(n,e)=>e,onDisconnect(){},onSubDisconnect(){}});try{n=yield d.getConfig("gj")}catch(o){}const t=[];if(n&&n.$imports){const e=yield p.TranspileAndGetAll(n.$imports.map(n=>({file:n.replace("💉","")})),"imports");t.push(...e.map(n=>c.getFirstItem(require(n.transpiledFile))))}n&&n.$components&&(yield l.transpileComponentsInit(n.$components)),r.BootstrapFramework(s.AppModule,[...t,e.CoreModule.forRoot({graphql:{openBrowser:a.nextOrDefault("--random",!0,n=>"true"!==n),buildAstDefinitions:!1,graphiQlPath:"/graphiql",graphiqlOptions:{endpointURL:"/graphiql"}},pubsub:{authentication:"pubsub-auth"},server:{randomPort:a.nextOrDefault("--random",!1),hapi:{port:a.nextOrDefault("--port",9e3,n=>Number(n)),routes:{cors:{origin:["*"],additionalHeaders:["Host","User-Agent","Accept","Accept-Language","Accept-Encoding","Access-Control-Request-Method","Access-Control-Allow-Origin","Access-Control-Request-Headers","Origin","ETag","clientId","Connection","Pragma","Cache-Control"]}}}}})]).subscribe(()=>console.log("Started"),console.log.bind(console))})}m()}
},{"./app/app.module":"app/app.module.ts","./helpers/args-extractors":"helpers/args-extractors.ts","./helpers/component.parser":"helpers/component.parser.ts","./helpers/get-first-item":"helpers/get-first-item.ts","./helpers/self-child":"helpers/self-child.ts","./helpers/set-config":"helpers/set-config.ts","./helpers/transpile-and-load":"helpers/transpile-and-load.ts"}]},{},["main.ts"], null)
//# sourceMappingURL=/main.js.map