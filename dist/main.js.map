{"version":3,"sources":["helpers/args-extractors.ts","helpers/typescript.builder.ts","helpers/set-config.ts","helpers/basic.template.ts","helpers/advanced-schema.ts","helpers/basic-schema.ts","app/app.module.ts","helpers/self-child.ts","main.ts"],"names":[],"mappings":"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","file":"main.js","sourceRoot":"../src","sourcesContent":["export const includes = i => process.argv.toString().includes(i);\nexport const nextOrDefault = (i, fb: any = true, type = p => p) => {\n  if (process.argv.toString().includes(i)) {\n    const isNextArgumentPresent = process.argv[process.argv.indexOf(i) + 1];\n    if (!isNextArgumentPresent) {\n      return fb;\n    }\n    if (isNextArgumentPresent.includes('--')) {\n      return fb;\n    }\n    return type(isNextArgumentPresent);\n  }\n  return fb;\n};\n","import { spawn } from 'child_process';\n\nexport const TranspileTypescript = (paths: string[], outDir: string) => {\n  return new Promise((resolve, reject) => {\n    const child = spawn('npx', [\n      'gapi',\n      'build',\n      '--glob',\n      `${paths.toString()}`,\n      '--outDir',\n      outDir\n    ]);\n    // child.stdout.pipe(process.stdout);\n    child.stderr.pipe(process.stderr);\n    child.on('close', (code: number) => resolve(code));\n  });\n};\n","import { promisify } from 'util';\nimport { exists, Stats, writeFile, stat, readFile, unlink, readFileSync } from 'fs';\nimport { TranspileTypescript } from './typescript.builder';\nimport { join } from 'path';\nimport { load } from 'js-yaml';\n\nexport async function getConfig(configFilename: string) {\n  let config;\n  try {\n    config = require('esm')(module)(\n      join(process.cwd(), `${configFilename}.js`)\n    );\n    console.log('JS Config', config)\n  } catch (e) {}\n  if (await promisify(exists)(`./${configFilename}.yml`)) {\n    const file = readFileSync(`./${configFilename}.yml`, {encoding: 'utf-8'})\n    config = load(file);\n    console.log('YML Config', config)\n  }\n  if (await promisify(exists)(`./${configFilename}.ts`)) {\n    console.log('Typescript Config', config)\n    const isMigrateTempConfigExists = await promisify(exists)(\n      './.gj/config.temp'\n    );\n    const TranspileAndWriteTemp = async (stats: Stats) => {\n      await TranspileTypescript([`/${configFilename}.ts`], './.gj');\n      console.log('Transpile complete!');\n      await promisify(writeFile)(\n        './.gj/config.temp',\n        stats.mtime.toISOString(),\n        { encoding: 'utf-8' }\n      );\n    };\n    const stats = await promisify(stat)(`./${configFilename}.ts`);\n    if (isMigrateTempConfigExists) {\n      const temp = await promisify(readFile)('./.gj/config.temp', {\n        encoding: 'utf-8'\n      });\n      if (new Date(temp).toISOString() !== stats.mtime.toISOString()) {\n        console.log(`${configFilename} configuration is new transpiling...`);\n        await TranspileAndWriteTemp(stats);\n      }\n    } else {\n      console.log(`Transpile ${configFilename}.ts...`);\n      await TranspileAndWriteTemp(stats);\n    }\n    config = require(join(process.cwd(), `./.gj`, `${configFilename}.js`));\n\n    try {\n      await promisify(unlink)(join('./.gj', `${configFilename}.js.map`));\n    } catch (e) {}\n  }\n  try {\n    config = JSON.parse(\n      await promisify(readFile)(join(process.cwd(), `${configFilename}.json`), {\n        encoding: 'utf-8'\n      })\n    );\n    console.log('Json Config', config)\n  } catch (e) {}\n\n  return config;\n}\n","export const basicTemplate = {\n  $mode: 'basic',\n  $types: {\n    user: {\n      pesho: 'string'\n    }\n  },\n  $schema: './schema.graphql',\n  $resolvers: {\n    findUser: {\n      gosho: 'omg',\n      pesho: 515151,\n      pesho2: 515151,\n      pesho3: 515151,\n      dadadada: 515151,\n      pesho4: 515151,\n      pesho5: [515151],\n      pesho6: ['515151']\n    },\n    findUser2: {\n      gosho: 'omg',\n      pesho: 22,\n      pesho2: 515151,\n      pesho3: 515151,\n      pesho4: 515151,\n      pesho5: 515151\n    }\n  }\n};\n","import {\n  GraphQLString,\n  GraphQLList,\n  GraphQLInt,\n  GraphQLObjectType,\n  GraphQLNonNull,\n  GraphQLBoolean\n} from 'graphql';\nimport { BootstrapService } from '@gapi/core';\n\nfunction strEnum<T extends string>(o: Array<T>): {[K in T]: K} {\n  return o.reduce((res, key) => {\n      res[key] = key;\n      return res;\n  }, Object.create(null));\n}\n\nconst BooleanUnion = strEnum([\n  'Boolean',\n  'Bool',\n  'boolean'\n])\n\nconst StringUnion = strEnum([\n  'String',\n  'string'\n])\n\nconst IntegerUnion = strEnum([\n  'Int',\n  'integer',\n  'number',\n  'Num',\n  'int'\n])\n\ntype BooleanUnion = keyof typeof BooleanUnion;\ntype StringUnion = keyof typeof StringUnion;\ntype IntegerUnion = keyof typeof IntegerUnion;\n\nconst Roots = {\n  booleanNode: BooleanUnion,\n  stringNode: StringUnion,\n  numberNode: IntegerUnion\n}\n\nexport function MakeAdvancedSchema(config, bootstrap: BootstrapService) {\n  const types = {};\n\n  Object.keys(config.$types).forEach(type => {\n    if (types[type]) {\n      return;\n    }\n    Object.keys(config.$types[type]).forEach(key => {\n      types[type] = types[type] || {};\n      const ck = config.$types[type][key];\n\n      if (ck === 'string' || ck === 'String') {\n        types[type][key] = { type: GraphQLString };\n      }\n\n      if (ck === 'boolean' || ck === 'Boolean') {\n        types[type][key] = { type: GraphQLString };\n      }\n\n      if (ck === 'number' || ck === 'Number') {\n        types[type][key] = { type: GraphQLInt };\n      }\n\n      if (ck === 'string[]' || ck === 'String[]' || ck === '[String]') {\n        types[type][key] = { type: new GraphQLList(GraphQLString) };\n      }\n\n      if (ck === 'boolean[]' || ck === 'Boolean[]' || ck === '[Boolean]') {\n        types[type][key] = { type: new GraphQLList(GraphQLString) };\n      }\n\n      if (ck === 'number[]' || ck === 'Number[]' || ck === '[Number]') {\n        types[type][key] = { type: new GraphQLList(GraphQLInt) };\n      }\n    });\n    types[type] = new GraphQLObjectType({\n      name: type,\n      fields: types[type]\n    });\n  });\n  const buildArgumentsSchema = (args: { [key: string]: string }) => {\n    const fields = {};\n    args = args || fields;\n    Object.keys(args).forEach(a => {\n      const ck = args[a];\n\n      /* Basic */\n      if (ck === 'string' || ck === 'String') {\n        fields[a] = { type: GraphQLString };\n      }\n\n      if (ck === 'boolean' || ck === 'Boolean' || ck === 'Bool') {\n        fields[a] = { type: GraphQLBoolean };\n      }\n\n      if (ck === 'number' || ck === 'Number' || ck === 'Int') {\n        fields[a] = { type: GraphQLInt };\n      }\n\n      /* False negative */\n      if (ck === 'string!' || ck === 'String!') {\n        fields[a] = { type: new GraphQLNonNull(GraphQLString) };\n      }\n\n      if (ck === 'boolean!' || ck === 'Boolean!') {\n        fields[a] = { type: new GraphQLNonNull(GraphQLString) };\n      }\n\n      if (ck === 'number!' || ck === 'Number!' || ck === 'Int') {\n        fields[a] = { type: new GraphQLNonNull(GraphQLInt) };\n      }\n\n      /* Array */\n      if (ck === 'string[]' || ck === 'String[]' || ck === '[String]') {\n        fields[a] = { type: new GraphQLList(GraphQLString) };\n      }\n\n      if (ck === 'boolean[]' || ck === 'Boolean[]' || ck === '[Boolean]' || ck === '[Bool]') {\n        fields[a] = { type: new GraphQLList(GraphQLBoolean) };\n      }\n\n      if (ck === 'number[]' || ck === 'Number[]' || ck === '[Number]' || ck === '[Int]') {\n        fields[a] = { type: new GraphQLList(GraphQLInt) };\n      }\n\n      /* False negative Array */\n      if (ck === 'string[]!' || ck === 'String[]!' || ck === '[String]!') {\n        fields[a] = {\n          type: new GraphQLNonNull(new GraphQLList(GraphQLString))\n        };\n      }\n\n      if (ck === 'boolean[]!' || ck === 'Boolean[]!' || ck === '[Boolean]!' || ck === '[Bool]') {\n        fields[a] = {\n          type: new GraphQLNonNull(new GraphQLList(GraphQLBoolean))\n        };\n      }\n\n      if (ck === 'number[]!' || ck === 'Number[]!' || ck === '[Number]!' || ck === '[Int]!') {\n        fields[a] = {\n          type: new GraphQLNonNull(new GraphQLList(GraphQLInt))\n        };\n      }\n    \n    });\n    return fields;\n  };\n  Object.keys(config.$resolvers).forEach(method_name => {\n    const resolve = config.$resolvers[method_name].resolve;\n    const type = config.$resolvers[method_name].type;\n    if (!types[type]) {\n      throw new Error(\n        `Missing type '${type}', Available types: '${Object.keys(\n          types\n        ).toString()}'`\n      );\n    }\n    bootstrap.Fields.query[method_name] = {\n      type: types[type],\n      method_name,\n      args: buildArgumentsSchema(config.$resolvers[method_name].args),\n      public: true,\n      method_type: 'query',\n      target: () => {},\n      resolve: typeof resolve === 'function' ? resolve : () => resolve\n    } as any;\n  });\n}\n","import {\n  GraphQLString,\n  GraphQLInt,\n  GraphQLList,\n  GraphQLObjectType,\n  GraphQLBoolean\n} from 'graphql';\nimport { BootstrapService } from '@gapi/core';\n\nexport function MakeBasicSchema(config, bootstrap: BootstrapService) {\n  Object.keys(config.$resolvers).forEach(method_name => {\n    const resolve = config.$resolvers[method_name];\n    const fields = {};\n    const args = {};\n\n    Object.keys(resolve).forEach(key => {\n      const resolver = resolve[key];\n      if (typeof resolver === 'string') {\n        fields[key] = { type: GraphQLString };\n      }\n\n      if (typeof resolver === 'number') {\n        fields[key] = { type: GraphQLInt };\n      }\n      if (typeof resolver === 'boolean') {\n        fields[key] = { type: GraphQLBoolean };\n      }\n      if (typeof resolver !== 'string' && resolver.length) {\n        if (typeof resolver[0] === 'string') {\n          fields[key] = { type: new GraphQLList(GraphQLString) };\n        }\n\n        if (typeof resolver[0] === 'number') {\n          fields[key] = { type: new GraphQLList(GraphQLInt) };\n        }\n        if (typeof resolver[0] === 'boolean') {\n          fields[key] = { type: new GraphQLList(GraphQLBoolean) };\n        }\n      }\n    });\n    bootstrap.Fields.query[method_name] = {\n      type: new GraphQLObjectType({\n        name: `${method_name}_type`,\n        fields: () => fields\n      }),\n      args,\n      method_name,\n      public: true,\n      method_type: 'query',\n      target: () => {},\n      resolve: typeof resolve === 'function' ? resolve : () => resolve\n    } as any;\n  });\n}\n","import {\n  Module,\n  SCHEMA_OVERRIDE,\n  BootstrapService,\n  GraphQLSchema,\n  printSchema,\n  buildSchema,\n  mergeSchemas\n} from '@gapi/core';\nimport { writeFile, readFileSync } from 'fs';\nimport { promisify } from 'util';\nimport { includes, nextOrDefault } from '../helpers/args-extractors';\nimport { VoyagerModule } from '@gapi/voyager';\nimport { getConfig } from '../helpers/set-config';\nimport { basicTemplate } from '../helpers/basic.template';\nimport { MakeAdvancedSchema } from '../helpers/advanced-schema';\nimport { MakeBasicSchema } from '../helpers/basic-schema';\nimport { join } from 'path';\n\n@Module({\n  imports: [VoyagerModule.forRoot()],\n  providers: [\n    {\n      provide: SCHEMA_OVERRIDE,\n      useFactory: () => (schema: GraphQLSchema) => {\n        let externalSchema;\n        try {\n          const config = JSON.parse(\n            readFileSync(join(process.cwd(), 'gj.json'), {\n              encoding: 'utf-8'\n            })\n          );\n          config.$schema = config.$schema || nextOrDefault('--schema', false);\n          if (config.$schema) {\n            externalSchema = readFileSync(config.$schema, {\n              encoding: 'utf-8'\n            });\n            externalSchema = buildSchema(externalSchema)\n          }\n        } catch (e) {}\n        const mergedSchemas = mergeSchemas({\n          schemas: [externalSchema, schema].filter(i => !!i)\n        });\n        if (includes('--verbose')) {\n          console.log(`\nSchema:\n${printSchema(mergedSchemas)}\n                  `);\n        }\n\n        if (process.argv.toString().includes('--generate')) {\n          promisify(writeFile)('./schema.graphql', printSchema(mergedSchemas), {\n            encoding: 'utf-8'\n          }).then(() => {\n            console.log('Schema created!');\n            process.exit(0);\n          });\n        } else {\n          console.log(\n            'You can extract this schema by running --generate command'\n          );\n        }\n        return mergedSchemas;\n      }\n    },\n    {\n      provide: 'createFields',\n      deps: [BootstrapService],\n      lazy: true,\n      useFactory: async (bootstrap: BootstrapService) => {\n        let config = await getConfig(\n          nextOrDefault('--config', 'graphqj-config')\n        );\n        if (!config) {\n          config = await getConfig('gj');\n        }\n        if (!config) {\n          config = basicTemplate;\n        }\n        config = config['default'] || config;\n\n        if (config.$mode === 'basic') {\n          MakeBasicSchema(config, bootstrap);\n        }\n\n        if (config.$mode === 'advanced') {\n          MakeAdvancedSchema(config, bootstrap);\n        }\n        return true;\n      }\n    }\n  ]\n})\nexport class AppModule {}\n","import { spawn, ChildProcessWithoutNullStreams } from 'child_process';\nimport { Observable } from 'rxjs';\n\nexport const SelfChild = (configFile: string) => {\n  return new Observable<ChildProcessWithoutNullStreams>(observer => {\n    const args = []\n    args.push('--config')\n    args.push(configFile)\n    const child = spawn('gj', args);\n    child.stdout.pipe(process.stdout);\n    child.stderr.pipe(process.stderr);\n    process.on('exit', () => child.kill());\n    observer.next(child);\n    return () => {\n      observer.complete();\n      child.kill();\n      console.log(`Child process: ${child.pid} killed`);\n    };\n  });\n};\n","import { BootstrapFramework } from '@rxdi/core';\nimport { AppModule } from './app/app.module';\nimport { CoreModule } from '@gapi/core';\nimport { nextOrDefault, includes } from './helpers/args-extractors';\nimport { writeFile, existsSync } from 'fs';\nimport { promisify } from 'util';\nimport { watch } from 'chokidar';\nimport { SelfChild } from './helpers/self-child';\nimport { Subscription } from 'rxjs';\n\nif (includes('--watch')) {\n  let subscription: Subscription;\n  const configPath = nextOrDefault('--config');\n  if (!existsSync(configPath)) {\n    throw new Error(`File missing ${configPath}`);\n  }\n  const ignored = (p: string) => p.includes('node_modules');\n\n  watch(configPath, { ignored }).on('change', async (event, path) => {\n    if (subscription) {\n      subscription.unsubscribe();\n    }\n    subscription = SelfChild(configPath).subscribe(process => {\n      console.log('Child process started: ', process.pid);\n    });\n  });\n\n  watch(configPath, { ignored }).on('ready', async (event, path) => {\n    if (subscription) {\n      subscription.unsubscribe();\n    }\n    subscription = SelfChild(configPath).subscribe(process => {\n      console.log('Child process started: ', process.pid);\n    });\n  });\n} else if (includes('init')) {\n  if (includes('advanced')) {\n    promisify(writeFile)(\n      './gj.json',\n      `\n{\n  \"$mode\": \"advanced\",\n  \"$types\": {\n    \"user\": {\n      \"name\": \"String\",\n      \"email\": \"String\",\n      \"phone\": \"Number\",\n      \"arrayOfNumbers\": \"Number[]\",\n      \"arrayOfStrings\": \"String[]\"\n    }\n  },\n  \"$resolvers\": {\n    \"findUser\": {\n      \"type\": \"user\",\n      \"resolve\": {\n        \"name\": \"Kristiyan Tachev\",\n        \"email\": \"test@gmail.com\",\n        \"phone\": 414141,\n        \"arrayOfNumbers\": [515151, 412414],\n        \"arrayOfStrings\": [\"515151\", \"412414\"]\n      }\n    }\n  }\n}`,\n      { encoding: 'utf-8' }\n    );\n  } else if (includes('es6')) {\n    promisify(writeFile)(\n      './gj.js',\n      `\nexport default {\n  $mode: 'advanced',\n  $types: {\n    user: {\n      name: 'String',\n      email: 'String',\n      phone: 'Number',\n      arrayOfNumbers: 'Number[]',\n      arrayOfStrings: 'String[]'\n    }\n  },\n  $resolvers: {\n    findUser: {\n      type: 'user',\n      args: {\n        userId: \"String!\",\n        userId2: \"String\",\n      },\n      resolve: async (root, payload, context) => ({\n        name: 'Kristiyan Tachev',\n        email: 'test@gmail.com',\n        phone: 4141423,\n        arrayOfNumbers: [515151, 412414],\n        arrayOfStrings: ['515151', '412414']\n      })\n    }\n  }\n};\n`,\n      { encoding: 'utf-8' }\n    );\n  } else if (includes('typescript')) {\n    promisify(writeFile)(\n      './gj.ts',\n      `\nexport default {\n  $mode: 'advanced',\n  $types: {\n    user: {\n      name: 'String',\n      email: 'String',\n      phone: 'Number',\n      arrayOfNumbers: 'Number[]',\n      arrayOfStrings: 'String[]'\n    }\n  },\n  $resolvers: {\n    findUser: {\n      type: 'user',\n      args: {\n        userId: \"String!\",\n        userId2: \"String\",\n      },\n      resolve: async (root, payload: { userId: string; userId2?: string }) => ({\n        name: 'Kristiyan Tachev',\n        email: 'test@gmail.com',\n        phone: 4141423,\n        arrayOfNumbers: [515151, 412414],\n        arrayOfStrings: ['515151', '412414']\n      })\n    }\n  }\n};\n`,\n      { encoding: 'utf-8' }\n    );\n  }else if (includes('yml')) {\n    promisify(writeFile)(\n      './gj.yml',\n      `\n$mode: advanced\n$types:\n  user:\n    name: String\n    email: String\n    phone: Number\n    arrayOfNumbers: Number[]\n    arrayOfStrings: String[]\n\n$resolvers:\n  findUser:\n    type: user\n    args:\n      userId: String\n    resolve:\n      name: Kristiyan Tachev\n      email: test@gmail.com\n      phone: 414141\n      arrayOfNumbers: \n        - 515151\n        - 412414\n      arrayOfStrings:\n        - '515151'\n        - '412414'\n\n  findUser2:\n    type: user\n    args:\n      userId: String!\n    resolve:\n      name: Kristiyan Tachev\n      email: test@gmail.com\n      phone: 414141\n      arrayOfNumbers: \n        - 515151\n        - 412414\n      arrayOfStrings:\n        - '515151'\n        - '412414'\n`,\n      { encoding: 'utf-8' }\n    );\n  } else {\n    promisify(writeFile)(\n      './gj.json',\n      `\n{\n  \"$mode\": \"basic\",\n  \"$resolvers\": {\n    \"findUser\": {\n      \"name\": \"Kristiyan Tachev\",\n      \"email\": \"test@gmail.com\",\n      \"phone\": 414141,\n      \"arrayOfNumbers\": [515151, 412414],\n      \"arrayOfStrings\": [\"515151\", \"412414\"]\n    }\n  }\n}\n`,\n      { encoding: 'utf-8' }\n    );\n  }\n} else {\n  BootstrapFramework(AppModule, [\n    CoreModule.forRoot({\n      graphql: {\n        openBrowser: nextOrDefault('--random', true, v =>\n          v === 'true' ? false : true\n        )\n      },\n      server: {\n        randomPort: nextOrDefault('--random', false),\n        hapi: {\n          port: nextOrDefault('--port', 9000, p => Number(p))\n        }\n      }\n    })\n  ]).subscribe(() => console.log('Started'), console.log.bind(console));\n}\n"]}